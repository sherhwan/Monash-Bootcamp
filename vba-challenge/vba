Module 1
Sub Ticker(ws As Worksheet)

    ' Dim ws As worksheet
    ' Set ws = ThisWorkbook.Sheets("Q1") ' Replace "Sheet1" with your actual sheet name

    ws.Range("I1").Value = "Ticker"
    ws.Range("J1").Value = "Quarterly Change"
    ws.Range("K1").Value = "Percent Change"
    ws.Range("L1").Value = "Total stock volume"

    Dim Ticker As String
    Dim Total_stock_volulme As Double
    Dim summary_table_row As Integer
    Dim lastRow As Long
    Dim startPrice As Double
    Dim endPrice As Double

    Total_stock_volume = 0
    summary_table_row = 2

    ' Get the last row of data
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
     ' get the initial starting price
     startPrice = ws.Cells(2, 3).Value

    ' Loop through all ticker results
    For i = 2 To lastRow

        ' Check if we are still within the same ticker
        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then

            Ticker = ws.Cells(i, 1).Value
            Total_stock_volume = Total_stock_volume + ws.Cells(i, 7).Value
            endPrice = ws.Cells(i, 6).Value

            ' Print the ticker in the summary table
            ws.Cells(summary_table_row, 9).Value = Ticker
            ws.Cells(summary_table_row, 12).Value = Total_stock_volume
            
    
            ' Calculate and print the quarterly change and percent change

            ws.Cells(summary_table_row, 10).Value = endPrice - startPrice
            If startPrice <> 0 Then
                ws.Cells(summary_table_row, 11).Value = (endPrice - startPrice) / startPrice
            Else
                ws.Cells(summary_table_row, 11).Value = 0
            End If

            summary_table_row = summary_table_row + 1

            Total_stock_volume = 0
            
            ' find the next ticker starting price
            startPrice = ws.Cells(i + 1, 3).Value
            

        Else

            Total_stock_volume = Total_stock_volume + ws.Cells(i, 7).Value

        ' End If
        
        End If
        

    Next i
    

End Sub

Module 2
Sub bonus(ws As Worksheet)

    ws.Range("P1").Value = "Ticker"
    ws.Range("Q1").Value = "Value"
    ws.Range("O2").Value = "Greatest % increase"
    ws.Range("O3").Value = "Greatest % decrease"
    ws.Range("O4").Value = "Greatest total volume"

    Dim greatestIncrease As Double
    Dim greatestDecrease As Double
    Dim greatestTotalVolume As Double
    Dim lastRow As Long
    Dim tickerIncrease As String
    Dim tickerDecrease As String
    Dim tickerVolume As String
    
    ' Find the last row with data in column K
    lastRow = ws.Cells(ws.Rows.Count, 11).End(xlUp).Row

    ' Initialize variables
    greatestIncrease = ws.Cells(2, 11).Value
    greatestDecrease = ws.Cells(2, 11).Value
    greatestTotalVolume = ws.Cells(2, 12).Value

    ' Loop through each row to find the greatest increase, decrease, and total volume
    For i = 2 To lastRow
        If ws.Cells(i, 11).Value > greatestIncrease Then
            greatestIncrease = ws.Cells(i, 11).Value
            tickerIncrease = ws.Cells(i, 9).Value
        
        
        ElseIf ws.Cells(i, 11).Value < greatestDecrease Then
            greatestDecrease = ws.Cells(i, 11).Value
            tickerDecrease = ws.Cells(i, 9).Value
        
        
        ElseIf ws.Cells(i, 12).Value > greatestTotalVolume Then
            greatestTotalVolume = ws.Cells(i, 12).Value
            tickerVolume = ws.Cells(i, 9).Value
        End If
    Next i
    
    ' Output the results
    ws.Cells(2, 16).Value = tickerIncrease
    ws.Cells(2, 17).Value = greatestIncrease
    ws.Cells(3, 16).Value = tickerDecrease
    ws.Cells(3, 17).Value = greatestDecrease
    ws.Cells(4, 16).Value = tickerVolume
    ws.Cells(4, 17).Value = greatestTotalVolume

End Sub

Module 3
Sub formatting(ws As Worksheet)

Dim lastRow As Long
' Dim ws As worksheet
' Set ws = ThisWorkbook.Sheets("Q1")

' Determine the last row with data in column 1 (A)
lastRow = ws.Cells(ws.Rows.Count, 10).End(xlUp).Row

For i = 2 To lastRow
lastRow = ws.Cells(ws.Rows.Count, 10).End(xlUp).Row

' check if the change is above 0

If ws.Cells(i, 10).Value > 0 Then

'color the change to green
ws.Cells(i, 10).Interior.ColorIndex = 4

' check the change is less than 0
ElseIf ws.Cells(i, 10).Value < 0 Then

'color the change to red
ws.Cells(i, 10).Interior.ColorIndex = 3


' check the change is 0
Else
ws.Cells(i, 10).Value = 0

'color the change to red
ws.Cells(i, 10).Interior.ColorIndex = 0

End If
Next i


End Sub

Module 4 â€“ the governor module 
Sub allmodules()

    Dim ws As Worksheet
    

For Each ws In Worksheets

' MsgBox (ws.Name)


Call Ticker(ws)
Call bonus(ws)
Call formatting(ws)

Next


   End Sub
   
